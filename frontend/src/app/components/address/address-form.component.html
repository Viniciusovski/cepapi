<div class="address-form-container">
  <h2>{{ isEditMode ? 'Editar Endereço' : 'Novo Endereço' }}</h2>
  
  <form [formGroup]="addressForm" (ngSubmit)="onSubmit()">
    <div class="row">
      <div class="col-md-8">
        <div class="form-group">
          <label for="cep">CEP</label>
          <div class="input-group">
            <input type="text" id="cep" formControlName="cep" class="form-control" 
                   mask="00000-000" [ngClass]="{ 'is-invalid': submitted && f.cep.errors }">
            <div class="input-group-append">
              <button class="btn btn-outline-secondary" type="button" (click)="searchCep()">
                <i class="fas fa-search"></i> Buscar
              </button>
            </div>
          </div>
          <div *ngIf="submitted && f.cep.errors" class="invalid-feedback">
            <div *ngIf="f.cep.errors.required">CEP é obrigatório</div>
            <div *ngIf="f.cep.errors.minlength">CEP deve ter 8 dígitos</div>
          </div>
        </div>
      </div>
    </div>
    
    <div class="row">
      <div class="col-md-8">
        <div class="form-group">
          <label for="street">Logradouro</label>
          <input type="text" id="street" formControlName="street" class="form-control" 
                 [ngClass]="{ 'is-invalid': submitted && f.street.errors }">
          <div *ngIf="submitted && f.street.errors" class="invalid-feedback">
            <div *ngIf="f.street.errors.required">Logradouro é obrigatório</div>
          </div>
        </div>
      </div>
      
      <div class="col-md-4">
        <div class="form-group">
          <label for="number">Número</label>
          <input type="text" id="number" formControlName="number" class="form-control" 
                 [ngClass]="{ 'is-invalid': submitted && f.number.errors }">
          <div *ngIf="submitted && f.number.errors" class="invalid-feedback">
            <div *ngIf="f.number.errors.required">Número é obrigatório</div>
          </div>
        </div>
      </div>
    </div>
    
    <div class="row">
      <div class="col-md-6">
        <div class="form-group">
          <label for="complement">Complemento</label>
          <input type="text" id="complement" formControlName="complement" class="form-control">
        </div>
      </div>
      
      <div class="col-md-6">
        <div class="form-group">
          <label for="neighborhood">Bairro</label>
          <input type="text" id="neighborhood" formControlName="neighborhood" class="form-control" 
                 [ngClass]="{ 'is-invalid': submitted && f.neighborhood.errors }">
          <div *ngIf="submitted && f.neighborhood.errors" class="invalid-feedback">
            <div *ngIf="f.neighborhood.errors.required">Bairro é obrigatório</div>
          </div>
        </div>
      </div>
    </div>
    
    <div class="row">
      <div class="col-md-6">
        <div class="form-group">
          <label for="city">Cidade</label>
          <input type="text" id="city" formControlName="city" class="form-control" 
                 [ngClass]="{ 'is-invalid': submitted && f.city.errors }">
          <div *ngIf="submitted && f.city.errors" class="invalid-feedback">
            <div *ngIf="f.city.errors.required">Cidade é obrigatória</div>
          </div>
        </div>
      </div>
      
      <div class="col-md-6">
        <div class="form-group">
          <label for="state">Estado</label>
          <input type="text" id="state" formControlName="state" class="form-control" 
                 [ngClass]="{ 'is-invalid': submitted && f.state.errors }" maxlength="2">
          <div *ngIf="submitted && f.state.errors" class="invalid-feedback">
            <div *ngIf="f.state.errors.required">Estado é obrigatório</div>
            <div *ngIf="f.state.errors.minlength">Estado deve ter 2 caracteres</div>
          </div>
        </div>
      </div>
    </div>
    
    <div class="form-group">
      <button type="submit" class="btn btn-primary" [disabled]="loading">
        <span *ngIf="loading" class="spinner-border spinner-border-sm"></span>
        {{ isEditMode ? 'Atualizar' : 'Salvar' }}
      </button>
      <button type="button" class="btn btn-outline-secondary ml-2" (click)="cancel()">
        Cancelar
      </button>
    </div>
  </form>
  
  <div *ngIf="loading" class="loading-overlay">
    <div class="spinner-border text-primary" role="status">
      <span class="sr-only">Carregando...</span>
    </div>
  </div>
</div>